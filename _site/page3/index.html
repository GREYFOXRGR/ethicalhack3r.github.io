<!DOCTYPE html>
<html>
<head>   
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

		<title> Home </title>
    <meta name="description" content="Information security blog for Dewhurst Security.">

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

</head>
<body class="home-template">

    
    <header class="site-head" >
    <div class="vertical">
        <div class="site-head-content" class="inner">
           <h1 class="blog-title">Dewhurst Security Blog</h1>
        </div>
    </div>
</header>

<main class="content" role="main">

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2012-07-19">19 Jul 2012</time> </span>
            <h2 class="post-title"><a href="/2012/07/19/staticburp-burp-suite-potential-dom-xss-analysis.html">StaticBurp - Burp Suite potential DOM XSS Analysis</a></h2>

        </header>
        <section class="post-excerpt">
            A few weeks a go I had an idea.

<blockquote class="twitter-tweet"><p>JavaScript Taint Analysis for DOM <a href="https://twitter.com/search/%2523XSS">#XSS</a> in Burp would be an awesome feature to have! // cc: @<a href="https://twitter.com/portswigger">portswigger</a></p>&mdash; Ryan Dewhurst (@ethicalhack3r) <a href="https://twitter.com/ethicalhack3r/status/218459472450961408" data-datetime="2012-06-28T21:42:51+00:00">June 28, 2012</a></blockquote>
<script src="//platform.twitter.com/widgets.js" charset="utf-8"></script>

When I get ideas that I think have something worth while in them I note them down for future reference.

The three main points to get this working were:

<li>Take Burp response body.</li>
<li>Extract JavaScript.</li>
<li>Perform Taint Analysis.</li>

The first step was to somehow extract HTML responses from Burp Suite, luckily someone had already written a Ruby Burp extender called <a href="http://emonti.github.com/buby/">Buby</a>. I followed <a href="http://carnal0wnage.attackresearch.com/2011/05/buby-script-basics-part-1.html">this</a> awesome series of blog posts to get myself aquatinted with Buby.

The next step is to extract the JavaScript from the HTML responses, this is quite trivial to do with the <a href="http://nokogiri.org/">Nokogiri</a> Ruby gem.

The third step is to analyse the extracted JavaScript for Sinks, Sources and Securing functions (Taint Analysis). This was the hard part, for me at least. Finding this information proved to be hard, I did find some data, however, in the end this is where I stopped pursuing my idea.


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2012-05-20">20 May 2012</time> </span>
            <h2 class="post-title"><a href="/2012/05/20/devbug-php-static-code-analysis.html">DevBug - PHP Static Code Analysis</a></h2>

        </header>
        <section class="post-excerpt">
            My final year university dissertation was on the topic of Static Code Analysis, specifically the integration of IDEs (Integrated Development Environments) with Static Code Analysis. The idea was to make Static Code Analysis accesible to the developer, without them having to install and use additional specialist Static Code Analysis software.

Due to my familiarity with PHP and its lack of interpreter taint analysis I decided that I would write a PHP Static Code Analysis application. The PHP Static Code Analysis tool I developed is called DevBug, it is an online PHP Static Code Analysis tool written mostly in JavaScript (jQuery). The Static Code Analysis engine uses the sources, securing functions and sinks data from the awesome <a href="http://sourceforge.net/projects/rips-scanner/" target="_blank">RIPS</a> Static Code Analysis tool to identify specific PHP functions that can cause or remediate user input caused vulnerabilities. DevBug uses Taint Analysis to identify tainted variables, follows the tainted variables through the code, untaints the variables if they are secured and finally detects whether or not tainted variables end up in in sensitive sinks.

The IDE used is called <a href="http://codemirror.net/" target="_blank">CodeMirror</a> that provides a code editing area, syntax highlighting, line numbering and an API. CodeMirror was slightly modified to detect deprecated PHP functions and highlight them.


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2012-05-09">09 May 2012</time> </span>
            <h2 class="post-title"><a href="/2012/05/09/old-school-hacking.html">Old School hacking</a></h2>

        </header>
        <section class="post-excerpt">
            Back in the late nineties, around 1999, my mother bought me my first computer. Around this time The Matrix movie was released which as a young boy with a new computer had me Yahoo'ing (Google was largely unknown) for the term 'hacking'. Back then Yahoo! Chat was still around and had a chat room called the 'Hackers Lounge', everyone in there was talking about all sorts of cool things you could do with computers that I had never heard of before. With hindsight, most of the people in the chat room were script kiddies who knew how to run a few Windows GUI 'hacking' tools and largely acting like they were the kings of the Internet. At the time I wanted to learn about all of the cool things they knew. I started downloading and learning how to use these 'hacking' tools by the use of my guinea pig friends and family (my siblings soon grew tired of me remotely opening and closing their CD-ROM drives).

Some of these tools are still actively developed and used today, invaluable to conducting modern Penetration Testing and security audits. For the sake of nostalgia, I present to you some of the coolest most 1337 'hacking' tools that I and others used 'back in the day'. Warning: Download links not verified.

<strong>Legion by Rhino9</strong>

Use: Windows Null Session share scanner.
Released: 1999
Platform: Windows
Further Info: <a href="http://www.informit.com/articles/article.aspx?p=26263&seqNum=5" target="_blank">http://www.informit.com/articles/article.aspx?p=26263&seqNum=5</a>
Download: <a href="http://packetstormsecurity.org/files/14711/legion.zip.html" title="legion download" target="_blank">http://packetstormsecurity.org/files/14711/legion.zip.html</a>

<a href="http://www.ethicalhack3r.co.uk/wp-content/uploads/2012/05/legion_rhino9.gif"><img src="http://www.ethicalhack3r.co.uk/wp-content/uploads/2012/05/legion_rhino9-300x229.gif" alt="Legion Rhino9" title="legion_rhino9" width="300" height="229" class="alignnone size-medium wp-image-16768" /></a>


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2012-02-13">13 Feb 2012</time> </span>
            <h2 class="post-title"><a href="/2012/02/13/wireless-man-in-the-middle-mitm.html">Wireless Man In The Middle (MITM)</a></h2>

        </header>
        <section class="post-excerpt">
            <p>This is a recent piece I did for the BBC Inside Out program that originally aired on February 6th. In the video I demonstrate a wireless <a href="http://en.wikipedia.org/wiki/Man-in-the-middle_attack" target="_blank">Main In The Middle (MITM)</a> attack in a coffee shop using a FON+ wireless router, Karma and <a href="http://www.digininja.org/jasager/" target="_blank">Jasager</a>. Oh, and they're the ones who call me an 'expert', personally, I hate the term and would never call myself one.</p>

<p><iframe width="420" height="315" src="http://www.youtube.com/embed/J6Lch5fhlO4" frameborder="0" allowfullscreen></iframe></p>

        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2012-01-20">20 Jan 2012</time> </span>
            <h2 class="post-title"><a href="/2012/01/20/prevention-of-unwanted-telemarketing-calls.html">Prevention of unwanted telemarketing calls</a></h2>

        </header>
        <section class="post-excerpt">
            <p>I am tired of receiving multiple telemarketing calls per day, I'm tired of the <a href="http://www.tpsonline.org.uk/tps/index.html" target="_blank">Telephone Preference Service (TPS)</a> not having an affect and I'm tired of telecommunication companies charging for prevention features which should be free.</p>

<p>I came across an e-petition that was setup by a Rob Whitelock, it is not perfect in its recommendations but certainly puts the general point across.</p>

<blockquote><p>e-petitions is an easy way for you to influence government policy in the UK. You can create an e-petition about anything that the government is responsible for and if it gets at least 100,000 signatures, it will be eligible for debate in the House of Commons.</p></blockquote>

<p>You can help by signing the petition here;<br />
<a href="http://epetitions.direct.gov.uk/petitions/17324" target="_blank">http://epetitions.direct.gov.uk/petitions/17324</a></p>

        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2012-01-03">03 Jan 2012</time> </span>
            <h2 class="post-title"><a href="/2012/01/03/wordpress-3-3-cross-site-scripting-xss.html">WordPress 3.3 Cross-Site Scripting (XSS)</a></h2>

        </header>
        <section class="post-excerpt">
            Yesterday two Indian security researchers, Aditya Modha & Samir Shah, released an <a href="http://oldmanlab.blogspot.com/2012/01/wordpress-33-xss-vulnerability.html" target="_blank">advisory</a> outlining a Cross-Site Scripting (XSS) vulnerability within the latest version (at the time of writing) of WordPress 3.3. Many people started re-tweeting the news (including myself) and <a href="http://thehackernews.com/2012/01/zero-day-reflected-cross-site-scripting.html" target="_blank">blogging</a> about it. The problem came when I tried to reproduce the vulnerability, I couldn't.

I started to think that the vulnerability was a miss-understanding or publicity stunt and was getting annoyed at the many people who were spreading miss-information. I contacted the researchers over <a href="http://www.twitter.com/oldmanlab" target="_blank">Twitter</a> and told them that I was unable to reproduce the vulnerability in any browser or on any WordPress installation including vanilla installs.

The researchers got back in touch with a link to a WordPress installation on which the vulnerability worked. The URL they gave me was an IP address. Within their environment the XSS worked.

At this point I think even the researchers were puzzled. They sent me this code that they believed was the function causing the XSS within wp-includes/functions.php <a href="http://pastebin.com/iBnpN8Zm" target="_blank">http://pastebin.com/iBnpN8Zm</a>.


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-12-11">11 Dec 2011</time> </span>
            <h2 class="post-title"><a href="/2011/12/11/wordpress-plugin-disqus-comment-system-xss.html">WordPress Plugin Disqus Comment System XSS</a></h2>

        </header>
        <section class="post-excerpt">
            # Exploit Title: WordPress Plugin Disqus Comment System < = 2.68 Reflected Cross-Site Scripting (XSS)
# Google Dork: inurl:/wp-content/plugins/disqus-comment-system/
# Date: 11.12.11
# Author: Ryan Dewhurst (@ethicalhack3r)
# Software Link: http://downloads.wordpress.org/plugin/disqus-comment-system.2.68.zip
# Version: 2.68
# Tested on: Cross-Platform

** Vulnerability Description **

The WordPress Disqus Commment System version 2.68 was found to be effected by Reflected Cross-Site Scripting (XSS). At the time of writing the plugin (not version) had been downloaded 504,746 times. [0]


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-11-27">27 Nov 2011</time> </span>
            <h2 class="post-title"><a href="/2011/11/27/ec-council-ceh-unethical-behavior.html">EC-Council - CEH - Unethical Behavior</a></h2>

        </header>
        <section class="post-excerpt">
            The EC-Council or 'The International Council of E-Commerce Consultants' as they like to call themselves offer a range of different services, mostly in the field of Information Security training and certifications. One of their certifications, the Certified Ethical Hacker (CEH) claims to aspire to training 'ethical' hackers. 

<blockquote>"CEHv7 provides a comprehensive ethical hacking and network security-training program to meet the standards of highly skilled security professionals."</blockquote>

What I have found is the way the EC-Council promote their CEH is less than ethical and damn right unethical.

A comment left on my blog quite a while ago (2010/04/20 at 6:18 am), looked fairly authentic, however, when investigating a little further it was clear to me that the comment was in fact SPAM.

<blockquote>"smith said...
Hey folks, Thanks for sharing your views,article includes a very good information about the ethical hacking, the most interesting job in the field of computer security is being an ethical hacker,so i striven into the field of CEH, for more information on CEH check this link http://www.eccouncil.org/certification/certified_ethical_hacker.aspx"</blockquote>


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-11-25">25 Nov 2011</time> </span>
            <h2 class="post-title"><a href="/2011/11/25/wpscan-1-1-released.html">WPScan 1.1 released</a></h2>

        </header>
        <section class="post-excerpt">
            I am pleased to announce, after 5 months of work, that WPScan version 1.1 has been released!

With 780 more lines of code the most notable changes are:

Detection for 750 more plugins.
Detection for 107 new plugin vulnerabilities.
Detection for 447 possible timthumb file locations.
Advanced version fingerprinting implemented.
Full Path Disclosure (FPD) checks.
Auto updates.
Progress indicators.
Improved custom 404 checking.
Improved plugin detection.
Improved error_log checking.
Lots of bugs fixed.
Lots of small tweaks.

A full list of changes can be found here:
<a href="http://code.google.com/p/wpscan/source/browse/trunk/CHANGELOG" target="_blank">http://code.google.com/p/wpscan/source/browse/trunk/CHANGELOG</a>


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-11-23">23 Nov 2011</time> </span>
            <h2 class="post-title"><a href="/2011/11/23/wordpress-in-the-wild-and-wpscan-update.html">WordPress 'In the Wild' and WPScan Update</a></h2>

        </header>
        <section class="post-excerpt">
            As part of my on-going interest in WordPress security I wanted to find out for myself what the state of security was like on installations in the wild.

A list of servers running WordPress was acquired from <a href="http://www.shodanhq.com/" target="_blank">Shodan</a> by searching for a particular HTTP response header and its value. The list contained 10,000 entries, I don't know for sure, but I assume the list contained servers from around the world and was fairly random.

An Open Source project I have been working on, <a href="http://code.google.com/p/wpscan/" target="_blank">WPScan</a>, a WordPress security scanner, was used to passively scan 100 of those WordPress installations. This was done partly to test the scanner for any defects and also to gather data about the security of WordPress installations in the wild.


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-10-05">05 Oct 2011</time> </span>
            <h2 class="post-title"><a href="/2011/10/05/full-path-disclosure-fpd.html">Full Path Disclosure (FPD)</a></h2>

        </header>
        <section class="post-excerpt">
            Many people including developers, vendors and security professionals believe that Full Path Disclosure (FPD) is mainly a Security Misconfiguration problem rather than a Input Sanitation or Error Handling problem. I'm not saying that they are wrong, but I hope to convince them that it is more of a coding bug than a configuration bug. I want to put my argument over as to why I think FPD is a bug in source code and not in configuration. 

<strong>What is Full Path Disclosure (FPD)?</strong>

According to OWASP:
"Full Path Disclosure (FPD) vulnerabilities enable the attacker to see the path to the webroot/file. e.g.: /home/omg/htdocs/file/. Certain vulnerabilities, such as using the load_file() (within a SQL Injection) query to view the page source, require the attacker to have the full path to the file they wish to view."
<a href="https://www.owasp.org/index.php/Full_Path_Disclosure" target="_blank">https://www.owasp.org/index.php/Full_Path_Disclosure</a>

For me this is a very vague description of what FPD really is. FPD occurs when a web application encounters an error that is displayed to the user; the error includes the full path to the file the error occurred in possibly along with other debugging information.

<strong>Why is it a problem?</strong>

It's just the path of the file from the root directory, what's all the fuss about?


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-10-04">04 Oct 2011</time> </span>
            <h2 class="post-title"><a href="/2011/10/04/concrete5.html">Concrete5 <= 5.4.2.1 SQL Injection and XSS Vulnerabilities</a></h2>

        </header>
        <section class="post-excerpt">
            # Exploit Title: Concrete5 < = 5.4.2.1 SQL Injection and XSS Vulnerabilities
# Date: 2011-10-04
# Author: Ryan Dewhurst (ryandewhurst at gmail) (@ethicalhack3r)(www.ethicalhack3r.co.uk)
# Software Link: http://sourceforge.net/projects/concretecms/files/concrete5/5.4.2.1/
# Version: 5.4.2.1 (tested)

1.Vulnerability Description

Multiple SQL Injection, Cross-Site Scripting (XSS) and Information Disclosure vulnerabilities were identified within Concrete5 version 5.4.2.1

Please note: Only a select few vulnerabilities are outlined in this disclosure, many other vulnerabilities were discovered. Due to time restraints only a small sample of the vulnerabilities are outlined below. The vendor was contacted and replied promptly. Further assistance was asked for but not delivered due to my time constraints.

2.Software Description

CMS made for Marketing but built for Geeks, concrete5 [0] is a content management system that is free and open source.


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-09-27">27 Sep 2011</time> </span>
            <h2 class="post-title"><a href="/2011/09/27/video-wpscan-and-metasploits-meterpreter.html">[Video] WPScan and Metasploit's Meterpreter</a></h2>

        </header>
        <section class="post-excerpt">
            <p>Video demonstrating the PoC of WPScan using Metasploit's meterpreter to exploit a vulnerable WordPress plugin.</p>

<p><iframe src="http://player.vimeo.com/video/29660886?title=0&amp;byline=0&amp;portrait=0" width="600" height="500" frameborder="0" webkitAllowFullScreen allowFullScreen></iframe>
<p><a href="http://vimeo.com/29660886">WPScan and Metasploit's Meterpreter</a> from <a href="http://vimeo.com/user8685865">ryan dewhurst</a> on <a href="http://vimeo.com">Vimeo</a>.</p>

        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-09-14">14 Sep 2011</time> </span>
            <h2 class="post-title"><a href="/2011/09/14/es-metasploit-db_autopwn-contra-windows-8.html">[ES] Metasploit db_autopwn contra Windows 8</a></h2>

        </header>
        <section class="post-excerpt">
            Mi primer blog post en Español! <em>(lo siento si mi Español escrito no es perfecto)</em>

Ayer (o el anterior) Microsoft hizo disponible "Windows 8 Developer Preview" para cualquier persona poder descargar. Yo hize la instalación en <a href="http://www.virtualbox.org/" target="_blank">VirtualBox</a> siguiendo este <a href="http://geekswithblogs.net/RollingIT/archive/2011/09/14/getting-hands-on-with-virtual-machine-of-windows-8.aspx" target="_blank">guía</a> (en Ingles).

Quería ver si Microsoft posiblemente han usado algunas librerías/programas de versiones de Windows antiguos que posiblemente tengan vulnerabilidades remotos y que el <a href="http://metasploit.com/" target="_blank">Metesploit</a> tenga un exploit para el.

Para esto quería usar el db_autopwn para que Metasploit use todos los exploits que tenga para los puertos que Windows 8 Developer tenga abierto. Al mismo ves será un test rápido y sencillo.

<em>(Configuración para BT5 R1, usando Metasploit revision 13728)</em>


        </section>
    </article>

    

    <article class="post">
        <header class="post-header">
            <span class="post-meta"><time datetime="2011-09-08">08 Sep 2011</time> </span>
            <h2 class="post-title"><a href="/2011/09/08/setting-up-tor-on-backtrack.html">Setting up Tor on BackTrack</a></h2>

        </header>
        <section class="post-excerpt">
            I was playing around with getting <a href="http://www.randomstorm.com/wpscan-security-tool.php" target="_blank">wpscan</a> to run through the <a href="http://www.torproject.org/" target="_blank">Tor</a> network so I needed to setup Tor (from source) and <a href="http://www.privoxy.org/" target="_blank">Privoxy</a> on <a href="http://www.backtrack-linux.org/" target="_blank">BackTrack</a>. These are the steps I took to setup Tor and Privoxy on Backtrack 5 R1. (wpscan does not yet support scanning through the Tor network)

I am no Tor expert and there are probably easier/better ways of doing this.

<strong>Installing Tor (Anonymous SOCKS proxy):</strong>

<blockquote>
$apt-get install libssl-dev
$wget https://www.torproject.org/dist/tor-0.2.2.32.tar.gz
$tar -xzvf tor-0.2.2.32.tar.gz
$cd tor-0.2.2.32
$chmod +x configure
$./configure && make && src/or/tor
</blockquote>


        </section>
    </article>

    

    <nav class="pagination" role="pagination">

        
          
          <a class="newer-posts" href="/page2/" title="Previous Page">&laquo; Newer Posts</a>
          
        

        <span class="page-number"> Page 3 of 9 </span>
        
         
        <a class="older-posts" href="/page4/" title="Next Page">Older Posts &raquo;</a>
         
    </nav>
    

</main>


    <footer class="site-footer">
        <div class="inner">
            <section class="copyright">All content copyright <a href="http://blog.dewhurstsecurity.com">Dewhurst Security Blog</a> &copy;  &bull; All rights reserved.</section>
        </div>
    </footer>

    
    <script type="text/javascript" src="/assets/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>
    
    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3292649-12', 'auto');
      ga('send', 'pageview');
    </script>

</body>
</html>
